{"remainingRequest":"C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\src\\components\\Map.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\src\\components\\Map.vue","mtime":1588347906068},{"path":"C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Matt Medley\\Desktop\\eat24\\g01\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgJFNjcmlwdGpzIGZyb20gInNjcmlwdGpzIjsNCmltcG9ydCB7IGV2ZW50QnVzIH0gZnJvbSAiQC9ldmVudC1idXMuanMiOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJNYXAiLA0KDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG1hcDogbnVsbCwNCiAgICAgIG1hcmtlcjogbnVsbCwNCiAgICAgIGxhc3RMYXQ6IG51bGwsDQogICAgICBsYXN0TG5nOiBudWxsLA0KDQogICAgICBnZXROZXh0UGFnZTogbnVsbCwNCiAgICAgIERFRkFVTFRfTEFUOiA0Mi4wMzQ1MzQsDQogICAgICBERUZBVUxUX0xORzogLTkzLjYyMDM2OSwNCg0KICAgICAgZ2VvY29kZXI6IG51bGwsDQogICAgICBwbGFjZXNTZXJ2aWNlOiBudWxsLA0KICAgIH07DQogIH0sDQoNCiAgbW91bnRlZDogZnVuY3Rpb24oKSB7DQogICAgJFNjcmlwdGpzKA0KICAgICAgImh0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9qcz9rZXk9QUl6YVN5QXcxaGNsWW9UeE1UTGtoTjZZemRKb0M0MnMtT0FNbzhRJmxpYnJhcmllcz1nZW9tZXRyeSxwbGFjZXMiLA0KICAgICAgKCkgPT4gew0KICAgICAgICB0aGlzLmluaXRNYXAoKTsNCiAgICAgIH0NCiAgICApOw0KDQogICAgZXZlbnRCdXMuJG9uKCJuZXdUZXh0QWRkcmVzcyIsIChwYXlsb2FkKSA9PiB7DQogICAgICB0aGlzLnVwZGF0ZUZyb21UZXh0QWRkcmVzcyhwYXlsb2FkKTsNCiAgICB9KTsNCg0KICAgIGV2ZW50QnVzLiRvbigic2VuZENpdHlEYXRhIiwgKHBheWxvYWQpID0+IHsNCiAgICAgIHRoaXMucmVuZGVyQ2l0eU1hcChwYXlsb2FkLmNvb3JkaW5hdGVzKTsNCiAgICAgIHRoaXMuc2V0RGF0YUxheWVyKHBheWxvYWQubXVsdGlQb2x5LCBwYXlsb2FkLm51bUdlb21ldHJpZXMpOw0KICAgIH0pOw0KDQogICAgZXZlbnRCdXMuJG9uKCJsYXVuY2hLZXl3b3JkU2VhcmNoIiwgKHBheWxvYWQpID0+IHsNCiAgICAgIHRoaXMuZG9LZXl3b3JkU2VhcmNoKHBheWxvYWQpOw0KICAgIH0pOw0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICB3YWl0KHRpbWVvdXQpIHsNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gew0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICByZXNvbHZlKCk7DQogICAgICAgIH0sIHRpbWVvdXQpOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIHVwZGF0ZUZyb21UZXh0QWRkcmVzcyhwYXlsb2FkKSB7DQogICAgICB0aGlzLm1hcC5zZXRDZW50ZXIocGF5bG9hZC5nZW9tZXRyeS5sb2NhdGlvbik7DQogICAgICB0aGlzLnVwZGF0ZU1hcmtlcihwYXlsb2FkLmdlb21ldHJ5LmxvY2F0aW9uKTsNCiAgICAgIHRoaXMubGFzdExhdCA9IHBheWxvYWQuZ2VvbWV0cnkubG9jYXRpb24ubGF0KCk7DQogICAgICB0aGlzLmxhc3RMbmcgPSBwYXlsb2FkLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpOw0KICAgIH0sDQoNCiAgICByZW5kZXJDaXR5TWFwKG15Q2l0eURhdGEpIHsNCiAgICAgIG15Q2l0eURhdGEuc2V0TWFwKHRoaXMubWFwKTsNCg0KICAgICAgbXlDaXR5RGF0YS5hZGRMaXN0ZW5lcigiY2xpY2siLCAoZXZlbnQpID0+IHsNCiAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcih0aGlzLm1hcCwgImNsaWNrIiwgZXZlbnQpOw0KICAgICAgfSk7DQogICAgfSwNCg0KICAgIGluaXRNYXAoKSB7DQogICAgICB0aGlzLmdlb2NvZGVyID0gbmV3IGdvb2dsZS5tYXBzLkdlb2NvZGVyKCk7DQoNCiAgICAgIHRoaXMubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgibWFwIiksIHsNCiAgICAgICAgY2VudGVyOiB7DQogICAgICAgICAgbGF0OiB0aGlzLkRFRkFVTFRfTEFULA0KICAgICAgICAgIGxuZzogdGhpcy5ERUZBVUxUX0xORywNCiAgICAgICAgfSwNCiAgICAgICAgem9vbTogNCwNCiAgICAgICAgZ2VzdHVyZUhhbmRsaW5nOiAiZ3JlZWR5IiwNCiAgICAgIH0pOw0KDQogICAgICB0aGlzLnBsYWNlc1NlcnZpY2UgPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlBsYWNlc1NlcnZpY2UodGhpcy5tYXApOw0KDQogICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcih0aGlzLm1hcCwgImNsaWNrIiwgKGV2ZW50KSA9PiB7DQogICAgICAgIHRoaXMubGFzdExhdCA9IGV2ZW50LmxhdExuZy5sYXQoKTsNCiAgICAgICAgdGhpcy5sYXN0TG5nID0gZXZlbnQubGF0TG5nLmxuZygpOw0KDQogICAgICAgIHRoaXMudXBkYXRlTWFya2VyKGV2ZW50LmxhdExuZyk7DQoNCiAgICAgICAgdGhpcy5nZW9jb2Rlci5nZW9jb2RlKHsgbG9jYXRpb246IGV2ZW50LmxhdExuZyB9LCAocmVzdWx0cywgc3RhdHVzKSA9PiB7DQogICAgICAgICAgaWYgKHJlc3VsdHMpIHsNCiAgICAgICAgICAgIGV2ZW50QnVzLiRlbWl0KCJtYXBBZGRyZXNzIiwgcmVzdWx0cyk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgICAgZXZlbnRCdXMuJGVtaXQoImdvb2dsZUluaXQiLCB7fSk7DQogICAgfSwNCg0KICAgIHVwZGF0ZU1hcmtlcihsYXRMbmcpIHsNCiAgICAgIGlmICghdGhpcy5tYXJrZXIpIHsNCiAgICAgICAgdGhpcy5tYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHsNCiAgICAgICAgICBtYXA6IHRoaXMubWFwLA0KICAgICAgICB9KTsNCiAgICAgIH0NCg0KICAgICAgdGhpcy5tYXJrZXIuc2V0UG9zaXRpb24obGF0TG5nKTsNCiAgICB9LA0KDQogICAgZG9TZWFyY2gocGFyYW1zKSB7DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KICAgICAgdGhpcy5wbGFjZXNTZXJ2aWNlLm5lYXJieVNlYXJjaChwYXJhbXMsIGFzeW5jIGZ1bmN0aW9uKA0KICAgICAgICByZXN1bHRzLA0KICAgICAgICBQbGFjZXNTZXJ2aWNlU3RhdHVzLA0KICAgICAgICBQbGFjZVNlYXJjaFBhZ2luYXRpb24NCiAgICAgICkgew0KICAgICAgICBpZiAoUGxhY2VzU2VydmljZVN0YXR1cyAhPT0gIk9LIikgcmV0dXJuOw0KDQogICAgICAgIF90aGlzLnNlYXJjaFJlc3VsdE1hcmtlcnMocmVzdWx0cyk7DQoNCiAgICAgICAgaWYgKFBsYWNlU2VhcmNoUGFnaW5hdGlvbi5oYXNOZXh0UGFnZSkgew0KICAgICAgICAgIGF3YWl0IF90aGlzLndhaXQoMTAwKTsNCiAgICAgICAgICBfdGhpcy5nZXROZXh0UGFnZSA9DQogICAgICAgICAgICBQbGFjZVNlYXJjaFBhZ2luYXRpb24uaGFzTmV4dFBhZ2UgJiYNCiAgICAgICAgICAgIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICBQbGFjZVNlYXJjaFBhZ2luYXRpb24ubmV4dFBhZ2UoKTsNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgX3RoaXMuZ2V0TmV4dFBhZ2UgPSBudWxsOw0KICAgICAgICB9DQogICAgICAgIGlmIChfdGhpcy5nZXROZXh0UGFnZSkgew0KICAgICAgICAgIF90aGlzLmdldE5leHRQYWdlKCk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICBnb29nbGVQbGFjZXNTZWFyY2goa2V5d29yZCwgcmFkaXVzID0gMTAwMCkgew0KICAgICAgaWYgKCFrZXl3b3JkLnRyaW0oKSkgcmV0dXJuOw0KDQogICAgICBsZXQgcGFyYW1zID0gew0KICAgICAgICBsb2NhdGlvbjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh0aGlzLmxhc3RMYXQsIHRoaXMubGFzdExuZyksDQogICAgICAgIHJhZGl1czogcmFkaXVzLA0KICAgICAgICBrZXl3b3JkOiBrZXl3b3JkLA0KICAgICAgfTsNCg0KICAgICAgdGhpcy5kb1NlYXJjaChwYXJhbXMpOw0KICAgIH0sDQoNCiAgICBkb0tleXdvcmRTZWFyY2goa2V5d29yZCkgew0KICAgICAgdGhpcy5nb29nbGVQbGFjZXNTZWFyY2goa2V5d29yZCwgNTAwKTsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;;;AASA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-flex xs4>\r\n    <v-card>\r\n      <div id=\"map\"></div>\r\n    </v-card>\r\n  </v-flex>\r\n</template>\r\n\r\n<script>\r\nimport $Scriptjs from \"scriptjs\";\r\nimport { eventBus } from \"@/event-bus.js\";\r\n\r\nexport default {\r\n  name: \"Map\",\r\n\r\n  data() {\r\n    return {\r\n      map: null,\r\n      marker: null,\r\n      lastLat: null,\r\n      lastLng: null,\r\n\r\n      getNextPage: null,\r\n      DEFAULT_LAT: 42.034534,\r\n      DEFAULT_LNG: -93.620369,\r\n\r\n      geocoder: null,\r\n      placesService: null,\r\n    };\r\n  },\r\n\r\n  mounted: function() {\r\n    $Scriptjs(\r\n      \"https://maps.googleapis.com/maps/api/js?key=AIzaSyAw1hclYoTxMTLkhN6YzdJoC42s-OAMo8Q&libraries=geometry,places\",\r\n      () => {\r\n        this.initMap();\r\n      }\r\n    );\r\n\r\n    eventBus.$on(\"newTextAddress\", (payload) => {\r\n      this.updateFromTextAddress(payload);\r\n    });\r\n\r\n    eventBus.$on(\"sendCityData\", (payload) => {\r\n      this.renderCityMap(payload.coordinates);\r\n      this.setDataLayer(payload.multiPoly, payload.numGeometries);\r\n    });\r\n\r\n    eventBus.$on(\"launchKeywordSearch\", (payload) => {\r\n      this.doKeywordSearch(payload);\r\n    });\r\n  },\r\n\r\n  methods: {\r\n    wait(timeout) {\r\n      return new Promise((resolve) => {\r\n        setTimeout(() => {\r\n          resolve();\r\n        }, timeout);\r\n      });\r\n    },\r\n\r\n    updateFromTextAddress(payload) {\r\n      this.map.setCenter(payload.geometry.location);\r\n      this.updateMarker(payload.geometry.location);\r\n      this.lastLat = payload.geometry.location.lat();\r\n      this.lastLng = payload.geometry.location.lng();\r\n    },\r\n\r\n    renderCityMap(myCityData) {\r\n      myCityData.setMap(this.map);\r\n\r\n      myCityData.addListener(\"click\", (event) => {\r\n        google.maps.event.trigger(this.map, \"click\", event);\r\n      });\r\n    },\r\n\r\n    initMap() {\r\n      this.geocoder = new google.maps.Geocoder();\r\n\r\n      this.map = new google.maps.Map(document.getElementById(\"map\"), {\r\n        center: {\r\n          lat: this.DEFAULT_LAT,\r\n          lng: this.DEFAULT_LNG,\r\n        },\r\n        zoom: 4,\r\n        gestureHandling: \"greedy\",\r\n      });\r\n\r\n      this.placesService = new google.maps.places.PlacesService(this.map);\r\n\r\n      google.maps.event.addListener(this.map, \"click\", (event) => {\r\n        this.lastLat = event.latLng.lat();\r\n        this.lastLng = event.latLng.lng();\r\n\r\n        this.updateMarker(event.latLng);\r\n\r\n        this.geocoder.geocode({ location: event.latLng }, (results, status) => {\r\n          if (results) {\r\n            eventBus.$emit(\"mapAddress\", results);\r\n          }\r\n        });\r\n      });\r\n      eventBus.$emit(\"googleInit\", {});\r\n    },\r\n\r\n    updateMarker(latLng) {\r\n      if (!this.marker) {\r\n        this.marker = new google.maps.Marker({\r\n          map: this.map,\r\n        });\r\n      }\r\n\r\n      this.marker.setPosition(latLng);\r\n    },\r\n\r\n    doSearch(params) {\r\n      let _this = this;\r\n      this.placesService.nearbySearch(params, async function(\r\n        results,\r\n        PlacesServiceStatus,\r\n        PlaceSearchPagination\r\n      ) {\r\n        if (PlacesServiceStatus !== \"OK\") return;\r\n\r\n        _this.searchResultMarkers(results);\r\n\r\n        if (PlaceSearchPagination.hasNextPage) {\r\n          await _this.wait(100);\r\n          _this.getNextPage =\r\n            PlaceSearchPagination.hasNextPage &&\r\n            function() {\r\n              PlaceSearchPagination.nextPage();\r\n            };\r\n        } else {\r\n          _this.getNextPage = null;\r\n        }\r\n        if (_this.getNextPage) {\r\n          _this.getNextPage();\r\n        }\r\n      });\r\n    },\r\n\r\n    googlePlacesSearch(keyword, radius = 1000) {\r\n      if (!keyword.trim()) return;\r\n\r\n      let params = {\r\n        location: new google.maps.LatLng(this.lastLat, this.lastLng),\r\n        radius: radius,\r\n        keyword: keyword,\r\n      };\r\n\r\n      this.doSearch(params);\r\n    },\r\n\r\n    doKeywordSearch(keyword) {\r\n      this.googlePlacesSearch(keyword, 500);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n#map {\r\n  width: 40vw;\r\n  height: 30vw;\r\n}\r\n</style>\r\n"]}]}